var jsPDF=function(global){"use strict";function jsPDF(orientation,unit,format,compressPdf){var options={};"object"==typeof orientation&&(options=orientation,orientation=options.orientation,unit=options.unit||unit,format=options.format||format,compressPdf=options.compress||options.compressPdf||compressPdf),orientation="undefined"==typeof orientation?"p":orientation.toString().toLowerCase(),"undefined"==typeof unit&&(unit="mm"),"undefined"==typeof format&&(format="a4"),"undefined"==typeof compressPdf&&"undefined"==typeof zpipe&&(compressPdf=!1);var activeFontKey,pageHeight,pageWidth,k,tmp,plugin,wPt,hPt,kids,format_as_string=format.toString().toLowerCase(),content=[],content_length=0,compress=compressPdf,pdfVersion="1.3",pageFormats={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224]},textColor=options.textColor||"0 g",drawColor=options.drawColor||"0 G",page=0,pages=[],objectNumber=2,outToPages=!!options.outToPages,offsets=[],fonts={},fontmap={},activeFontSize=options.fontSize||16,lineWidth=options.lineWidth||.200025,lineHeightProportion=options.lineHeight||1.15,documentProperties={title:"",subject:"",author:"",keywords:"",creator:""},lineCapID=0,lineJoinID=0,API={},events=new PubSub(API),f2=function(number){return number.toFixed(2)},f3=function(number){return number.toFixed(3)},padd2=function(number){var n=number.toFixed(0);return 10>number?"0"+n:n},padd10=function(number){var n=number.toFixed(0);return n.length<10?new Array(11-n.length).join("0")+n:n},out=function(string){outToPages?pages[page].push(string):(content.push(string),content_length+=string.length+1)},newObject=function(){return objectNumber++,offsets[objectNumber]=content_length,out(objectNumber+" 0 obj"),objectNumber},putStream=function(str){out("stream"),out(str),out("endstream")},putPages=function(){wPt=pageWidth*k,hPt=pageHeight*k;var n,p,arr,i,deflater,adler32;for(n=1;page>=n;n++){if(newObject(),out("<</Type /Page"),out("/Parent 1 0 R"),out("/Resources 2 0 R"),out("/Contents "+(objectNumber+1)+" 0 R>>"),out("endobj"),p=pages[n].join("\n"),newObject(),compress){for(arr=[],i=0;i<p.length;++i)arr[i]=p.charCodeAt(i);adler32=adler32cs.from(p),deflater=new Deflater(6),deflater.append(new Uint8Array(arr)),p=deflater.flush(),arr=[new Uint8Array([120,156]),new Uint8Array(p),new Uint8Array([255&adler32,adler32>>8&255,adler32>>16&255,adler32>>24&255])],p="";for(i in arr)arr.hasOwnProperty(i)&&(p+=String.fromCharCode.apply(null,arr[i]));out("<</Length "+p.length+" /Filter [/FlateDecode]>>")}else out("<</Length "+p.length+">>");putStream(p),out("endobj")}for(offsets[1]=content_length,out("1 0 obj"),out("<</Type /Pages"),kids="/Kids [",i=0;page>i;i++)kids+=3+2*i+" 0 R ";out(kids+"]"),out("/Count "+page),out("/MediaBox [0 0 "+f2(wPt)+" "+f2(hPt)+"]"),out(">>"),out("endobj")},putFont=function(font){font.objectNumber=newObject(),out("<</BaseFont/"+font.PostScriptName+"/Type/Font"),"string"==typeof font.encoding&&out("/Encoding/"+font.encoding),out("/Subtype/Type1>>"),out("endobj")},putFonts=function(){var fontKey;for(fontKey in fonts)fonts.hasOwnProperty(fontKey)&&putFont(fonts[fontKey])},putXobjectDict=function(){events.publish("putXobjectDict")},putResourceDictionary=function(){out("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),out("/Font <<");var fontKey;for(fontKey in fonts)fonts.hasOwnProperty(fontKey)&&out("/"+fontKey+" "+fonts[fontKey].objectNumber+" 0 R");out(">>"),out("/XObject <<"),putXobjectDict(),out(">>")},putResources=function(){putFonts(),events.publish("putResources"),offsets[2]=content_length,out("2 0 obj"),out("<<"),putResourceDictionary(),out(">>"),out("endobj"),events.publish("postPutResources")},addToFontDictionary=function(fontKey,fontName,fontStyle){var undef;fontmap[fontName]===undef&&(fontmap[fontName]={}),fontmap[fontName][fontStyle]=fontKey},addFont=function(PostScriptName,fontName,fontStyle,encoding){var fontKey="F"+(getObjectLength(fonts)+1).toString(10),font=fonts[fontKey]={id:fontKey,PostScriptName:PostScriptName,fontName:fontName,fontStyle:fontStyle,encoding:encoding,metadata:{}};return addToFontDictionary(fontKey,fontName,fontStyle),events.publish("addFont",font),fontKey},addFonts=function(){var i,l,fontKey,parts,HELVETICA="helvetica",TIMES="times",COURIER="courier",NORMAL="normal",BOLD="bold",ITALIC="italic",BOLD_ITALIC="bolditalic",encoding="StandardEncoding",standardFonts=[["Helvetica",HELVETICA,NORMAL],["Helvetica-Bold",HELVETICA,BOLD],["Helvetica-Oblique",HELVETICA,ITALIC],["Helvetica-BoldOblique",HELVETICA,BOLD_ITALIC],["Courier",COURIER,NORMAL],["Courier-Bold",COURIER,BOLD],["Courier-Oblique",COURIER,ITALIC],["Courier-BoldOblique",COURIER,BOLD_ITALIC],["Times-Roman",TIMES,NORMAL],["Times-Bold",TIMES,BOLD],["Times-Italic",TIMES,ITALIC],["Times-BoldItalic",TIMES,BOLD_ITALIC]];for(i=0,l=standardFonts.length;l>i;i++)fontKey=addFont(standardFonts[i][0],standardFonts[i][1],standardFonts[i][2],encoding),parts=standardFonts[i][0].split("-"),addToFontDictionary(fontKey,parts[0],parts[1]||"");events.publish("addFonts",{fonts:fonts,dictionary:fontmap})},to8bitStream=function(text,flags){var i,l,undef,sourceEncoding,encodingBlock,outputEncoding,newtext,isUnicode,ch,bch;if(flags===undef&&(flags={}),sourceEncoding=flags.sourceEncoding?sourceEncoding:"Unicode",outputEncoding=flags.outputEncoding,(flags.autoencode||outputEncoding)&&fonts[activeFontKey].metadata&&fonts[activeFontKey].metadata[sourceEncoding]&&fonts[activeFontKey].metadata[sourceEncoding].encoding&&(encodingBlock=fonts[activeFontKey].metadata[sourceEncoding].encoding,!outputEncoding&&fonts[activeFontKey].encoding&&(outputEncoding=fonts[activeFontKey].encoding),!outputEncoding&&encodingBlock.codePages&&(outputEncoding=encodingBlock.codePages[0]),"string"==typeof outputEncoding&&(outputEncoding=encodingBlock[outputEncoding]),outputEncoding)){for(isUnicode=!1,newtext=[],i=0,l=text.length;l>i;i++)ch=outputEncoding[text.charCodeAt(i)],newtext.push(ch?String.fromCharCode(ch):text[i]),newtext[i].charCodeAt(0)>>8&&(isUnicode=!0);text=newtext.join("")}for(i=text.length;isUnicode===undef&&0!==i;)text.charCodeAt(i-1)>>8&&(isUnicode=!0),i--;if(isUnicode){for(newtext=flags.noBOM?[]:[254,255],i=0,l=text.length;l>i;i++){if(ch=text.charCodeAt(i),bch=ch>>8,bch>>8)throw new Error("Character at position "+i.toString(10)+" of string '"+text+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");newtext.push(bch),newtext.push(ch-(bch<<8))}return String.fromCharCode.apply(undef,newtext)}return text},pdfEscape=function(text,flags){return to8bitStream(text,flags).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},putInfo=function(){out("/Producer (jsPDF "+jsPDF.version+")"),documentProperties.title&&out("/Title ("+pdfEscape(documentProperties.title)+")"),documentProperties.subject&&out("/Subject ("+pdfEscape(documentProperties.subject)+")"),documentProperties.author&&out("/Author ("+pdfEscape(documentProperties.author)+")"),documentProperties.keywords&&out("/Keywords ("+pdfEscape(documentProperties.keywords)+")"),documentProperties.creator&&out("/Creator ("+pdfEscape(documentProperties.creator)+")");var created=new Date;out("/CreationDate (D:"+[created.getFullYear(),padd2(created.getMonth()+1),padd2(created.getDate()),padd2(created.getHours()),padd2(created.getMinutes()),padd2(created.getSeconds())].join("")+")")},putCatalog=function(){out("/Type /Catalog"),out("/Pages 1 0 R"),out("/OpenAction [3 0 R /FitH null]"),out("/PageLayout /OneColumn"),events.publish("putCatalog")},putTrailer=function(){out("/Size "+(objectNumber+1)),out("/Root "+objectNumber+" 0 R"),out("/Info "+(objectNumber-1)+" 0 R")},beginPage=function(){page++,outToPages=!0,pages[page]=[]},_addPage=function(){beginPage(),out(f2(lineWidth*k)+" w"),out(drawColor),0!==lineCapID&&out(lineCapID.toString(10)+" J"),0!==lineJoinID&&out(lineJoinID.toString(10)+" j"),events.publish("addPage",{pageNumber:page})},getFont=function(fontName,fontStyle){var key,undef;fontName===undef&&(fontName=fonts[activeFontKey].fontName),fontStyle===undef&&(fontStyle=fonts[activeFontKey].fontStyle);try{key=fontmap[fontName][fontStyle]}catch(e){key=undef}if(!key)throw new Error("Unable to look up font label for font '"+fontName+"', '"+fontStyle+"'. Refer to getFontList() for available fonts.");return key},buildDocument=function(){outToPages=!1,objectNumber=2,content=[],offsets=[],out("%PDF-"+pdfVersion),putPages(),putResources(),newObject(),out("<<"),putInfo(),out(">>"),out("endobj"),newObject(),out("<<"),putCatalog(),out(">>"),out("endobj");var i,o=content_length;for(out("xref"),out("0 "+(objectNumber+1)),out("0000000000 65535 f "),i=1;objectNumber>=i;i++)out(padd10(offsets[i])+" 00000 n ");return out("trailer"),out("<<"),putTrailer(),out(">>"),out("startxref"),out(o),out("%%EOF"),outToPages=!0,content.join("\n")},getStyle=function(style){var op="S";return"F"===style?op="f":("FD"===style||"DF"===style)&&(op="B"),op},getBlob=function(){var data,length,array,i,blob;for(data=buildDocument(),length=data.length,array=new Uint8Array(new ArrayBuffer(length)),i=0;length>i;i++)array[i]=data.charCodeAt(i);return blob=new Blob([array],{type:"application/pdf"})},output=function(type,options){var undef;switch(type){case undef:return buildDocument();case"save":if(navigator.getUserMedia){if(void 0===global.URL)return API.output("dataurlnewwindow");if(void 0===global.URL.createObjectURL)return API.output("dataurlnewwindow")}saveAs(getBlob(),options);break;case"blob":return getBlob();case"datauristring":case"dataurlstring":return"data:application/pdf;base64,"+btoa(buildDocument());case"datauri":case"dataurl":document.location.href="data:application/pdf;base64,"+btoa(buildDocument());break;case"dataurlnewwindow":global.open("data:application/pdf;base64,"+btoa(buildDocument()));break;default:throw new Error('Output type "'+type+'" is not supported.')}};if("pt"===unit)k=1;else if("mm"===unit)k=72/25.4;else if("cm"===unit)k=72/2.54;else{if("in"!==unit)throw"Invalid unit: "+unit;k=72}if(pageFormats.hasOwnProperty(format_as_string))pageHeight=pageFormats[format_as_string][1]/k,pageWidth=pageFormats[format_as_string][0]/k;else try{pageHeight=format[1],pageWidth=format[0]}catch(err){throw"Invalid format: "+format}if("p"===orientation||"portrait"===orientation)orientation="p",pageWidth>pageHeight&&(tmp=pageWidth,pageWidth=pageHeight,pageHeight=tmp);else{if("l"!==orientation&&"landscape"!==orientation)throw"Invalid orientation: "+orientation;orientation="l",pageHeight>pageWidth&&(tmp=pageWidth,pageWidth=pageHeight,pageHeight=tmp)}API.internal={pdfEscape:pdfEscape,getStyle:getStyle,getFont:function(){return fonts[getFont.apply(API,arguments)]},getFontSize:function(){return activeFontSize},getLineHeight:function(){return activeFontSize*lineHeightProportion},btoa:btoa,write:function(string1){out(1===arguments.length?string1:Array.prototype.join.call(arguments," "))},getCoordinateString:function(value){return f2(value*k)},getVerticalCoordinateString:function(value){return f2((pageHeight-value)*k)},collections:{},newObject:newObject,putStream:putStream,events:events,scaleFactor:k,pageSize:{width:pageWidth,height:pageHeight},output:function(type,options){return output(type,options)},getNumberOfPages:function(){return pages.length-1},pages:pages},API.addPage=function(){return _addPage(),this},API.text=function(text,x,y,flags,angle){if("number"==typeof text){var tmp=y;y=x,x=text,text=tmp}"string"==typeof text&&text.match(/[\n\r]/)&&(text=text.split(/\r\n|\r|\n/g)),"number"==typeof flags&&(angle=flags,flags=null);var xtra="",mode="Td";if(angle){angle*=Math.PI/180;var c=Math.cos(angle),s=Math.sin(angle);xtra=[f2(c),f2(s),f2(-1*s),f2(c),""].join(" "),mode="Tm"}if(flags=flags||{},"noBOM"in flags||(flags.noBOM=!0),"autoencode"in flags||(flags.autoencode=!0),"string"==typeof text)text=pdfEscape(text,flags);else{if(!(text instanceof Array))throw new Error('Type of text must be string or Array. "'+text+'" is not recognized.');for(var sa=text.concat(),da=[],len=sa.length;len--;)da.push(pdfEscape(sa.shift(),flags));text=da.join(") Tj\nT* (")}return out("BT\n/"+activeFontKey+" "+activeFontSize+" Tf\n"+activeFontSize*lineHeightProportion+" TL\n"+textColor+"\n"+xtra+f2(x*k)+" "+f2((pageHeight-y)*k)+" "+mode+"\n("+text+") Tj\nET"),this},API.line=function(x1,y1,x2,y2){return out(f2(x1*k)+" "+f2((pageHeight-y1)*k)+" m "+f2(x2*k)+" "+f2((pageHeight-y2)*k)+" l S"),this},API.lines=function(lines,x,y,scale,style,closed){var undef,_first,_second,_third,scalex,scaley,i,l,leg,x2,y2,x3,y3,x4,y4;for("number"==typeof lines&&(_first=y,_second=lines,_third=x,lines=_first,x=_second,y=_third),style=getStyle(style),scale=scale===undef?[1,1]:scale,out(f3(x*k)+" "+f3((pageHeight-y)*k)+" m "),scalex=scale[0],scaley=scale[1],l=lines.length,x4=x,y4=y,i=0;l>i;i++)leg=lines[i],2===leg.length?(x4=leg[0]*scalex+x4,y4=leg[1]*scaley+y4,out(f3(x4*k)+" "+f3((pageHeight-y4)*k)+" l")):(x2=leg[0]*scalex+x4,y2=leg[1]*scaley+y4,x3=leg[2]*scalex+x4,y3=leg[3]*scaley+y4,x4=leg[4]*scalex+x4,y4=leg[5]*scaley+y4,out(f3(x2*k)+" "+f3((pageHeight-y2)*k)+" "+f3(x3*k)+" "+f3((pageHeight-y3)*k)+" "+f3(x4*k)+" "+f3((pageHeight-y4)*k)+" c"));return 1==closed&&out(" h"),out(style),this},API.rect=function(x,y,w,h,style){var op=getStyle(style);return out([f2(x*k),f2((pageHeight-y)*k),f2(w*k),f2(-h*k),"re",op].join(" ")),this},API.triangle=function(x1,y1,x2,y2,x3,y3,style){return this.lines([[x2-x1,y2-y1],[x3-x2,y3-y2],[x1-x3,y1-y3]],x1,y1,[1,1],style,!0),this},API.roundedRect=function(x,y,w,h,rx,ry,style){var MyArc=4/3*(Math.SQRT2-1);return this.lines([[w-2*rx,0],[rx*MyArc,0,rx,ry-ry*MyArc,rx,ry],[0,h-2*ry],[0,ry*MyArc,-(rx*MyArc),ry,-rx,ry],[-w+2*rx,0],[-(rx*MyArc),0,-rx,-(ry*MyArc),-rx,-ry],[0,-h+2*ry],[0,-(ry*MyArc),rx*MyArc,-ry,rx,-ry]],x+rx,y,[1,1],style),this},API.ellipse=function(x,y,rx,ry,style){var op=getStyle(style),lx=4/3*(Math.SQRT2-1)*rx,ly=4/3*(Math.SQRT2-1)*ry;return out([f2((x+rx)*k),f2((pageHeight-y)*k),"m",f2((x+rx)*k),f2((pageHeight-(y-ly))*k),f2((x+lx)*k),f2((pageHeight-(y-ry))*k),f2(x*k),f2((pageHeight-(y-ry))*k),"c"].join(" ")),out([f2((x-lx)*k),f2((pageHeight-(y-ry))*k),f2((x-rx)*k),f2((pageHeight-(y-ly))*k),f2((x-rx)*k),f2((pageHeight-y)*k),"c"].join(" ")),out([f2((x-rx)*k),f2((pageHeight-(y+ly))*k),f2((x-lx)*k),f2((pageHeight-(y+ry))*k),f2(x*k),f2((pageHeight-(y+ry))*k),"c"].join(" ")),out([f2((x+lx)*k),f2((pageHeight-(y+ry))*k),f2((x+rx)*k),f2((pageHeight-(y+ly))*k),f2((x+rx)*k),f2((pageHeight-y)*k),"c",op].join(" ")),this},API.circle=function(x,y,r,style){return this.ellipse(x,y,r,r,style)},API.setProperties=function(properties){var property;for(property in documentProperties)documentProperties.hasOwnProperty(property)&&properties[property]&&(documentProperties[property]=properties[property]);return this},API.setFontSize=function(size){return activeFontSize=size,this},API.setFont=function(fontName,fontStyle){return activeFontKey=getFont(fontName,fontStyle),this},API.setFontStyle=API.setFontType=function(style){var undef;return activeFontKey=getFont(undef,style),this},API.getFontList=function(){var fontName,fontStyle,tmp,list={};for(fontName in fontmap)if(fontmap.hasOwnProperty(fontName)){list[fontName]=tmp=[];for(fontStyle in fontmap[fontName])fontmap[fontName].hasOwnProperty(fontStyle)&&tmp.push(fontStyle)}return list},API.setLineWidth=function(width){return out((width*k).toFixed(2)+" w"),this},API.setDrawColor=function(ch1,ch2,ch3,ch4){var color;return color=void 0===ch2||void 0===ch4&&ch1===ch2===ch3?"string"==typeof ch1?ch1+" G":f2(ch1/255)+" G":void 0===ch4?"string"==typeof ch1?[ch1,ch2,ch3,"RG"].join(" "):[f2(ch1/255),f2(ch2/255),f2(ch3/255),"RG"].join(" "):"string"==typeof ch1?[ch1,ch2,ch3,ch4,"K"].join(" "):[f2(ch1),f2(ch2),f2(ch3),f2(ch4),"K"].join(" "),out(color),this},API.setFillColor=function(ch1,ch2,ch3,ch4){var color;return color=void 0===ch2||void 0===ch4&&ch1===ch2===ch3?"string"==typeof ch1?ch1+" g":f2(ch1/255)+" g":void 0===ch4?"string"==typeof ch1?[ch1,ch2,ch3,"rg"].join(" "):[f2(ch1/255),f2(ch2/255),f2(ch3/255),"rg"].join(" "):"string"==typeof ch1?[ch1,ch2,ch3,ch4,"k"].join(" "):[f2(ch1),f2(ch2),f2(ch3),f2(ch4),"k"].join(" "),out(color),this},API.setTextColor=function(r,g,b){var patt=/#[0-9A-Fa-f]{6}/;if("string"==typeof r&&patt.test(r)){var hex=r.replace("#",""),bigint=parseInt(hex,16);r=bigint>>16&255,g=bigint>>8&255,b=255&bigint}return textColor=0===r&&0===g&&0===b||"undefined"==typeof g?f3(r/255)+" g":[f3(r/255),f3(g/255),f3(b/255),"rg"].join(" "),this},API.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},API.setLineCap=function(style){var id=this.CapJoinStyles[style];if(void 0===id)throw new Error("Line cap style of '"+style+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return lineCapID=id,out(id.toString(10)+" J"),this},API.setLineJoin=function(style){var id=this.CapJoinStyles[style];if(void 0===id)throw new Error("Line join style of '"+style+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return lineJoinID=id,out(id.toString(10)+" j"),this},API.output=output,API.save=function(filename){API.output("save",filename)};for(plugin in jsPDF.API)jsPDF.API.hasOwnProperty(plugin)&&("events"===plugin&&jsPDF.API.events.length?!function(events,newEvents){var eventname,handler_and_args,i;for(i=newEvents.length-1;-1!==i;i--)eventname=newEvents[i][0],handler_and_args=newEvents[i][1],events.subscribe.apply(events,[eventname].concat("function"==typeof handler_and_args?[handler_and_args]:handler_and_args))}(events,jsPDF.API.events):API[plugin]=jsPDF.API[plugin]);return addFonts(),activeFontKey="F1",_addPage(),events.publish("initialized"),API}"undefined"==typeof btoa&&(global.btoa=function(data){var o1,o2,o3,h1,h2,h3,h4,bits,r,b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",b64a=b64.split(""),i=0,ac=0,enc="",tmp_arr=[];do o1=data.charCodeAt(i++),o2=data.charCodeAt(i++),o3=data.charCodeAt(i++),bits=o1<<16|o2<<8|o3,h1=bits>>18&63,h2=bits>>12&63,h3=bits>>6&63,h4=63&bits,tmp_arr[ac++]=b64a[h1]+b64a[h2]+b64a[h3]+b64a[h4];while(i<data.length);return enc=tmp_arr.join(""),r=data.length%3,(r?enc.slice(0,r-3):enc)+"===".slice(r||3)}),"undefined"==typeof atob&&(global.atob=function(data){var o1,o2,o3,h1,h2,h3,h4,bits,b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=0,ac=0,dec="",tmp_arr=[];if(!data)return data;data+="";do h1=b64.indexOf(data.charAt(i++)),h2=b64.indexOf(data.charAt(i++)),h3=b64.indexOf(data.charAt(i++)),h4=b64.indexOf(data.charAt(i++)),bits=h1<<18|h2<<12|h3<<6|h4,o1=bits>>16&255,o2=bits>>8&255,o3=255&bits,tmp_arr[ac++]=64===h3?String.fromCharCode(o1):64===h4?String.fromCharCode(o1,o2):String.fromCharCode(o1,o2,o3);while(i<data.length);return dec=tmp_arr.join("")});var getObjectLength="function"==typeof Object.keys?function(object){return Object.keys(object).length}:function(object){var e,i=0;for(e in object)object.hasOwnProperty(e)&&i++;return i};return global.PubSub=function(context){this.topics={},this.context=context,this.publish=function(topic,args){if(this.topics[topic]){var fn,i,l,pair,currentTopic=this.topics[topic],toremove=[],emptyFunc=function(){};for(args=Array.prototype.slice.call(arguments,1),i=0,l=currentTopic.length;l>i;i++)pair=currentTopic[i],fn=pair[0],pair[1]&&(pair[0]=emptyFunc,toremove.push(i)),fn.apply(this.context,args);for(i=0,l=toremove.length;l>i;i++)currentTopic.splice(toremove[i],1)}},this.subscribe=function(topic,callback,once){return this.topics[topic]?this.topics[topic].push([callback,once]):this.topics[topic]=[[callback,once]],{topic:topic,callback:callback}},this.unsubscribe=function(token){if(this.topics[token.topic]){var i,l,currentTopic=this.topics[token.topic];for(i=0,l=currentTopic.length;l>i;i++)currentTopic[i][0]===token.callback&&currentTopic.splice(i,1)}}},jsPDF.API={events:[]},jsPDF.version="1.0.0-trunk","function"==typeof define?define(function(){return jsPDF}):global.jsPDF=jsPDF,jsPDF}(self);!function(API){"use strict";var getCharWidthsArray=API.getCharWidthsArray=function(text,options){options||(options={});var i,l,char_code,widths=options.widths?options.widths:this.internal.getFont().metadata.Unicode.widths,widthsFractionOf=widths.fof?widths.fof:1,kerning=options.kerning?options.kerning:this.internal.getFont().metadata.Unicode.kerning,kerningFractionOf=kerning.fof?kerning.fof:1,prior_char_code=0,default_char_width=widths[0]||widthsFractionOf,output=[];for(i=0,l=text.length;l>i;i++)char_code=text.charCodeAt(i),output.push((widths[char_code]||default_char_width)/widthsFractionOf+(kerning[char_code]&&kerning[char_code][prior_char_code]||0)/kerningFractionOf),prior_char_code=char_code;return output},getArraySum=function(array){for(var i=array.length,output=0;i;)i--,output+=array[i];return output},splitLongWord=(API.getStringUnitWidth=function(text,options){return getArraySum(getCharWidthsArray.call(this,text,options))},function(word,widths_array,firstLineMaxLen,maxLen){for(var answer=[],i=0,l=word.length,workingLen=0;i!==l&&workingLen+widths_array[i]<firstLineMaxLen;)workingLen+=widths_array[i],i++;answer.push(word.slice(0,i));var startOfLine=i;for(workingLen=0;i!==l;)workingLen+widths_array[i]>maxLen&&(answer.push(word.slice(startOfLine,i)),workingLen=0,startOfLine=i),workingLen+=widths_array[i],i++;return startOfLine!==i&&answer.push(word.slice(startOfLine,i)),answer}),splitParagraphIntoLines=function(text,maxlen,options){options||(options={});var word,widths_array,i,l,tmp,spaceCharWidth=getCharWidthsArray(" ",options)[0],words=text.split(" "),line=[],lines=[line],line_length=options.textIndent||0,separator_length=0,current_word_length=0;for(i=0,l=words.length;l>i;i++)if(word=words[i],widths_array=getCharWidthsArray(word,options),current_word_length=getArraySum(widths_array),line_length+separator_length+current_word_length>maxlen){if(current_word_length>maxlen){for(tmp=splitLongWord(word,widths_array,maxlen-(line_length+separator_length),maxlen),line.push(tmp.shift()),line=[tmp.pop()];tmp.length;)lines.push([tmp.shift()]);current_word_length=getArraySum(widths_array.slice(word.length-line[0].length))}else line=[word];lines.push(line),line_length=current_word_length,separator_length=spaceCharWidth}else line.push(word),line_length+=separator_length+current_word_length,separator_length=spaceCharWidth;var output=[];for(i=0,l=lines.length;l>i;i++)output.push(lines[i].join(" "));return output};API.splitTextToSize=function(text,maxlen,options){options||(options={});var paragraphs,fsize=options.fontSize||this.internal.getFontSize(),newOptions=function(options){var widths={0:1},kerning={};if(options.widths&&options.kerning)return{widths:options.widths,kerning:options.kerning};var f=this.internal.getFont(options.fontName,options.fontStyle),encoding="Unicode";return f.metadata[encoding]?{widths:f.metadata[encoding].widths||widths,kerning:f.metadata[encoding].kerning||kerning}:{widths:widths,kerning:kerning}}.call(this,options);paragraphs=text.match(/[\n\r]/)?text.split(/\r\n|\r|\n/g):[text];var fontUnit_maxLen=1*this.internal.scaleFactor*maxlen/fsize;newOptions.textIndent=options.textIndent?1*options.textIndent*this.internal.scaleFactor/fsize:0;var i,l,output=[];for(i=0,l=paragraphs.length;l>i;i++)output=output.concat(splitParagraphIntoLines(paragraphs[i],fontUnit_maxLen,newOptions));return output}}(jsPDF.API),function(jsPDFAPI){"use strict";var namespace="addImage_",supported_image_types=["jpeg","jpg","png"],putImage=function(img){var objectNumber=this.internal.newObject(),out=this.internal.write,putStream=this.internal.putStream;if(img.n=objectNumber,out("<</Type /XObject"),out("/Subtype /Image"),out("/Width "+img.w),out("/Height "+img.h),img.cs===this.color_spaces.INDEXED?out("/ColorSpace [/Indexed /DeviceRGB "+(img.pal.length/3-1)+" "+("smask"in img?objectNumber+2:objectNumber+1)+" 0 R]"):(out("/ColorSpace /"+img.cs),img.cs===this.color_spaces.DEVICE_CMYK&&out("/Decode [1 0 1 0 1 0 1 0]")),out("/BitsPerComponent "+img.bpc),"f"in img&&out("/Filter /"+img.f),"dp"in img&&out("/DecodeParms <<"+img.dp+">>"),"trns"in img&&img.trns.constructor==Array){for(var trns="",i=0,len=img.trns.length;len>i;i++)trns+=img.trns[i]+" "+img.trns[i]+" ";out("/Mask ["+trns+"]")}if("smask"in img&&out("/SMask "+(objectNumber+1)+" 0 R"),out("/Length "+img.data.length+">>"),putStream(img.data),out("endobj"),"smask"in img){var dp="/Predictor 15 /Colors 1 /BitsPerComponent "+img.bpc+" /Columns "+img.w,smask={w:img.w,h:img.h,cs:"DeviceGray",bpc:img.bpc,dp:dp,data:img.smask};"f"in img&&(smask.f=img.f),putImage.call(this,smask)}img.cs===this.color_spaces.INDEXED&&(this.internal.newObject(),out("<< /Length "+img.pal.length+">>"),putStream(this.arrayBufferToBinaryString(new Uint8Array(img.pal))),out("endobj"))},putResourcesCallback=function(){var images=this.internal.collections[namespace+"images"];for(var i in images)putImage.call(this,images[i])},putXObjectsDictCallback=function(){var image,images=this.internal.collections[namespace+"images"],out=this.internal.write;for(var i in images)image=images[i],out("/I"+image.i,image.n,"0","R")},checkCompressValue=function(value){return value&&"string"==typeof value&&(value=value.toUpperCase()),value in jsPDFAPI.image_compression?value:jsPDFAPI.image_compression.NONE},getImages=function(){var images=this.internal.collections[namespace+"images"];return images||(this.internal.collections[namespace+"images"]=images={},this.internal.events.subscribe("putResources",putResourcesCallback),this.internal.events.subscribe("putXobjectDict",putXObjectsDictCallback)),images},getImageIndex=function(images){var imageIndex=0;return images&&(imageIndex=Object.keys?Object.keys(images).length:function(o){var i=0;for(var e in o)o.hasOwnProperty(e)&&i++;return i}(images)),imageIndex},notDefined=function(value){return"undefined"==typeof value||null===value},generateAliasFromData=function(){return void 0},doesNotSupportImageType=function(type){return-1===supported_image_types.indexOf(type)},processMethodNotEnabled=function(type){return"function"!=typeof jsPDFAPI["process"+type.toUpperCase()]},isDOMElement=function(object){return"object"==typeof object&&1===object.nodeType},createDataURIFromElement=function(imageData,format){var canvas=document.createElement("canvas");canvas.width=imageData.clientWidth||imageData.width,canvas.height=imageData.clientHeight||imageData.height;var ctx=canvas.getContext("2d");if(!ctx)throw"addImage requires canvas to be supported by browser.";return ctx.drawImage(imageData,0,0,canvas.width,canvas.height),canvas.toDataURL("png"==format?"image/png":"image/jpeg")},checkImagesForAlias=function(imageData,images){var cached_info;if(images)for(var e in images)if(imageData===images[e].alias){cached_info=images[e];break}return cached_info},determineWidthAndHeight=function(w,h){return w||h||(w=-96,h=-96),0>w&&(w=-1*info.w*72/w/this.internal.scaleFactor),0>h&&(h=-1*info.h*72/h/this.internal.scaleFactor),0===w&&(w=h*info.w/info.h),0===h&&(h=w*info.h/info.w),[w,h]},writeImageToPDF=function(x,y,w,h,info,index,images){var dims=determineWidthAndHeight(w,h),coord=this.internal.getCoordinateString,vcoord=this.internal.getVerticalCoordinateString;w=dims[0],h=dims[1],images[index]=info,this.internal.write("q",coord(w),"0 0",coord(h),coord(x),vcoord(y+h),"cm /I"+info.i,"Do Q")};jsPDFAPI.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPERATION:"Seperation",DEVICE_N:"DeviceN"},jsPDFAPI.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"},jsPDFAPI.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},jsPDFAPI.isString=function(object){return"string"==typeof object},jsPDFAPI.extractInfoFromBase64DataURI=function(dataURI){return/^data:([\w]+?\/([\w]+?));base64,(.+?)$/g.exec(dataURI)},jsPDFAPI.supportsArrayBuffer=function(){return"function"==typeof ArrayBuffer},jsPDFAPI.isArrayBuffer=function(object){return this.supportsArrayBuffer()?object instanceof ArrayBuffer:!1},jsPDFAPI.isArrayBufferView=function(object){return this.supportsArrayBuffer()?object instanceof Int8Array||object instanceof Uint8Array||object instanceof Uint8ClampedArray||object instanceof Int16Array||object instanceof Uint16Array||object instanceof Int32Array||object instanceof Uint32Array||object instanceof Float32Array||object instanceof Float64Array:!1},jsPDFAPI.binaryStringToUint8Array=function(binary_string){for(var len=binary_string.length,bytes=new Uint8Array(len),i=0;len>i;i++)bytes[i]=binary_string.charCodeAt(i);return bytes},jsPDFAPI.arrayBufferToBinaryString=function(buffer){this.isArrayBuffer(buffer)&&(buffer=new Uint8Array(buffer));for(var binary_string="",len=buffer.byteLength,i=0;len>i;i++)binary_string+=String.fromCharCode(buffer[i]);return binary_string},jsPDFAPI.arrayBufferToBase64=function(arrayBuffer){for(var a,b,c,d,chunk,base64="",encodings="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bytes=new Uint8Array(arrayBuffer),byteLength=bytes.byteLength,byteRemainder=byteLength%3,mainLength=byteLength-byteRemainder,i=0;mainLength>i;i+=3)chunk=bytes[i]<<16|bytes[i+1]<<8|bytes[i+2],a=(16515072&chunk)>>18,b=(258048&chunk)>>12,c=(4032&chunk)>>6,d=63&chunk,base64+=encodings[a]+encodings[b]+encodings[c]+encodings[d];return 1==byteRemainder?(chunk=bytes[mainLength],a=(252&chunk)>>2,b=(3&chunk)<<4,base64+=encodings[a]+encodings[b]+"=="):2==byteRemainder&&(chunk=bytes[mainLength]<<8|bytes[mainLength+1],a=(64512&chunk)>>10,b=(1008&chunk)>>4,c=(15&chunk)<<2,base64+=encodings[a]+encodings[b]+encodings[c]+"="),base64},jsPDFAPI.createImageInfo=function(data,wd,ht,cs,bpc,f,imageIndex,alias,dp,trns,pal,smask){var info={alias:alias,w:wd,h:ht,cs:cs,bpc:bpc,i:imageIndex,data:data};return f&&(info.f=f),dp&&(info.dp=dp),trns&&(info.trns=trns),pal&&(info.pal=pal),smask&&(info.smask=smask),info},jsPDFAPI.addImage=function(imageData,format,x,y,w,h,alias,compression){if("number"==typeof format){var tmp=h;h=w,w=y,y=x,x=format,format=tmp||"jpeg"}var cached_info,dataAsBinaryString,images=getImages.call(this);if(compression=checkCompressValue(compression),format=format.toLowerCase(),notDefined(alias)&&(alias=generateAliasFromData(imageData)),isDOMElement(imageData)&&(imageData=createDataURIFromElement(imageData,format)),this.isString(imageData)){var base64Info=this.extractInfoFromBase64DataURI(imageData);base64Info?(format=base64Info[2],imageData=atob(base64Info[3]),this.supportsArrayBuffer()&&(dataAsBinaryString=imageData,imageData=this.binaryStringToUint8Array(imageData))):255!==imageData.charCodeAt(0)&&(cached_info=checkImagesForAlias(imageData,images))}if(doesNotSupportImageType(format))throw new Error("addImage currently only supports formats "+supported_image_types+", not '"+format+"'");if(processMethodNotEnabled(format))throw new Error("please ensure that the plugin for '"+format+"' support is added");var imageIndex=getImageIndex(images),info=cached_info;if(info||(info=this["process"+format.toUpperCase()](imageData,imageIndex,alias,compression,dataAsBinaryString)),!info)throw new Error("An unkwown error occurred whilst processing the image");

return writeImageToPDF.call(this,x,y,w,h,info,imageIndex,images),this};var getJpegSize=function(imgData){var width,height;if(255===!imgData.charCodeAt(0)||216===!imgData.charCodeAt(1)||255===!imgData.charCodeAt(2)||224===!imgData.charCodeAt(3)||!imgData.charCodeAt(6)==="J".charCodeAt(0)||!imgData.charCodeAt(7)==="F".charCodeAt(0)||!imgData.charCodeAt(8)==="I".charCodeAt(0)||!imgData.charCodeAt(9)==="F".charCodeAt(0)||0===!imgData.charCodeAt(10))throw new Error("getJpegSize requires a binary string jpeg file");for(var blockLength=256*imgData.charCodeAt(4)+imgData.charCodeAt(5),i=4,len=imgData.length;len>i;){if(i+=blockLength,255!==imgData.charCodeAt(i))throw new Error("getJpegSize could not find the size of the image");if(192===imgData.charCodeAt(i+1)||193===imgData.charCodeAt(i+1)||194===imgData.charCodeAt(i+1)||195===imgData.charCodeAt(i+1)||196===imgData.charCodeAt(i+1)||197===imgData.charCodeAt(i+1)||198===imgData.charCodeAt(i+1)||199===imgData.charCodeAt(i+1))return height=256*imgData.charCodeAt(i+5)+imgData.charCodeAt(i+6),width=256*imgData.charCodeAt(i+7)+imgData.charCodeAt(i+8),[width,height];i+=2,blockLength=256*imgData.charCodeAt(i)+imgData.charCodeAt(i+1)}},getJpegSizeFromBytes=function(data){var hdr=data[0]<<8|data[1];if(65496!==hdr)throw new Error("Supplied data is not a JPEG");for(var bytes,width,height,len=data.length,block=(data[4]<<8)+data[5],pos=4;len>pos;){if(pos+=block,bytes=readBytes(data,pos),block=(bytes[2]<<8)+bytes[3],(192===bytes[1]||194===bytes[1])&&255===bytes[0]&&block>7)return bytes=readBytes(data,pos+5),width=(bytes[2]<<8)+bytes[3],height=(bytes[0]<<8)+bytes[1],{width:width,height:height};pos+=2}throw new Error("getJpegSizeFromBytes could not find the size of the image")},readBytes=function(data,offset){return data.subarray(offset,offset+4)};jsPDFAPI.processJPEG=function(data,index,alias,compression,dataAsBinaryString){var dims,colorSpace=this.color_spaces.DEVICE_RGB,filter=this.decode.DCT_DECODE,bpc=8;return this.isString(data)?(dims=getJpegSize(data),this.createImageInfo(data,dims[0],dims[1],colorSpace,bpc,filter,index,alias)):(this.isArrayBuffer(data)&&(data=new Uint8Array(data)),this.isArrayBufferView(data)?(dims=getJpegSizeFromBytes(data),data=dataAsBinaryString||this.arrayBufferToBinaryString(data),this.createImageInfo(data,dims.width,dims.height,colorSpace,bpc,filter,index,alias)):null)},jsPDFAPI.processJPG=function(data,index,alias,compression,dataAsBinaryString){return this.processJPEG(data,index,alias,compression,dataAsBinaryString)}}(jsPDF.API);var saveAs=saveAs||navigator.msSaveBlob&&navigator.msSaveBlob.bind(navigator)||function(view){"use strict";var doc=view.document,get_URL=function(){return view.URL||view.webkitURL||view},URL=view.URL||view.webkitURL||view,save_link=doc.createElementNS("http://www.w3.org/1999/xhtml","a"),can_use_save_link="download"in save_link,click=function(node){var event=doc.createEvent("MouseEvents");return event.initMouseEvent("click",!0,!1,view,0,0,0,0,0,!1,!1,!1,!1,0,null),node.dispatchEvent(event)},webkit_req_fs=view.webkitRequestFileSystem,req_fs=view.requestFileSystem||webkit_req_fs||view.mozRequestFileSystem,throw_outside=function(ex){(view.setImmediate||view.setTimeout)(function(){throw ex},0)},force_saveable_type="application/octet-stream",fs_min_size=0,deletion_queue=[],process_deletion_queue=function(){for(var i=deletion_queue.length;i--;){var file=deletion_queue[i];"string"==typeof file?URL.revokeObjectURL(file):file.remove()}deletion_queue.length=0},dispatch=function(filesaver,event_types,event){event_types=[].concat(event_types);for(var i=event_types.length;i--;){var listener=filesaver["on"+event_types[i]];if("function"==typeof listener)try{listener.call(filesaver,event||filesaver)}catch(ex){throw_outside(ex)}}},FileSaver=function(blob,name){var object_url,target_view,slice,filesaver=this,type=blob.type,blob_changed=!1,get_object_url=function(){var object_url=get_URL().createObjectURL(blob);return deletion_queue.push(object_url),object_url},dispatch_all=function(){dispatch(filesaver,"writestart progress write writeend".split(" "))},fs_error=function(){(blob_changed||!object_url)&&(object_url=get_object_url(blob)),target_view&&(target_view.location.href=object_url),filesaver.readyState=filesaver.DONE,dispatch_all()},abortable=function(func){return function(){return filesaver.readyState!==filesaver.DONE?func.apply(this,arguments):void 0}},create_if_not_found={create:!0,exclusive:!1};return filesaver.readyState=filesaver.INIT,name||(name="download"),can_use_save_link&&(object_url=get_object_url(blob),save_link.href=object_url,save_link.download=name,click(save_link))?(filesaver.readyState=filesaver.DONE,void dispatch_all()):(view.chrome&&type&&type!==force_saveable_type&&(slice=blob.slice||blob.webkitSlice,blob=slice.call(blob,0,blob.size,force_saveable_type),blob_changed=!0),webkit_req_fs&&"download"!==name&&(name+=".download"),target_view=type===force_saveable_type||webkit_req_fs?view:view.open(),req_fs?(fs_min_size+=blob.size,void req_fs(view.TEMPORARY,fs_min_size,abortable(function(fs){fs.root.getDirectory("saved",create_if_not_found,abortable(function(dir){var save=function(){dir.getFile(name,create_if_not_found,abortable(function(file){file.createWriter(abortable(function(writer){writer.onwriteend=function(event){target_view.location.href=file.toURL(),deletion_queue.push(file),filesaver.readyState=filesaver.DONE,dispatch(filesaver,"writeend",event)},writer.onerror=function(){var error=writer.error;error.code!==error.ABORT_ERR&&fs_error()},"writestart progress write abort".split(" ").forEach(function(event){writer["on"+event]=filesaver["on"+event]}),writer.write(blob),filesaver.abort=function(){writer.abort(),filesaver.readyState=filesaver.DONE},filesaver.readyState=filesaver.WRITING}),fs_error)}),fs_error)};dir.getFile(name,{create:!1},abortable(function(file){file.remove(),save()}),abortable(function(ex){ex.code===ex.NOT_FOUND_ERR?save():fs_error()}))}),fs_error)}),fs_error)):void fs_error())},FS_proto=FileSaver.prototype,saveAs=function(blob,name){return new FileSaver(blob,name)};return FS_proto.abort=function(){var filesaver=this;filesaver.readyState=filesaver.DONE,dispatch(filesaver,"abort")},FS_proto.readyState=FS_proto.INIT=0,FS_proto.WRITING=1,FS_proto.DONE=2,FS_proto.error=FS_proto.onwritestart=FS_proto.onprogress=FS_proto.onwrite=FS_proto.onabort=FS_proto.onerror=FS_proto.onwriteend=null,view.addEventListener("unload",process_deletion_queue,!1),saveAs}(self);!function(jsPDFAPI){"use strict";var doesNotHavePngJS=function(){return"function"!=typeof PNG||"function"!=typeof FlateStream},canCompress=function(value){return value!==jsPDFAPI.image_compression.NONE&&hasCompressionJS()},hasCompressionJS=function(){var inst="function"==typeof Deflater;if(!inst)throw new Error("requires deflate.js for compression");return inst},compressBytes=function(bytes,lineLength,colorsPerPixel,compression){var level=5,filter_method=filterUp;switch(compression){case jsPDFAPI.image_compression.FAST:level=3,filter_method=filterSub;break;case jsPDFAPI.image_compression.MEDIUM:level=6,filter_method=filterAverage;break;case jsPDFAPI.image_compression.SLOW:level=9,filter_method=filterPaeth}bytes=applyPngFilterMethod(bytes,lineLength,colorsPerPixel,filter_method);var header=new Uint8Array(createZlibHeader(level)),checksum=adler32(bytes),deflate=new Deflater(level),a=deflate.append(bytes),cBytes=deflate.flush(),len=header.length+a.length+cBytes.length,cmpd=new Uint8Array(len+4);return cmpd.set(header),cmpd.set(a,header.length),cmpd.set(cBytes,header.length+a.length),cmpd[len++]=checksum>>>24&255,cmpd[len++]=checksum>>>16&255,cmpd[len++]=checksum>>>8&255,cmpd[len++]=255&checksum,jsPDFAPI.arrayBufferToBinaryString(cmpd)},createZlibHeader=function(bytes,level){var cm=8,cinfo=Math.LOG2E*Math.log(32768)-8,cmf=cinfo<<4|cm,hdr=cmf<<8,flevel=Math.min(3,(level-1&255)>>1);return hdr|=flevel<<6,hdr|=0,hdr+=31-hdr%31,[cmf,255&hdr&255]},adler32=function(array,param){for(var tlen,adler=1,s1=65535&adler,s2=adler>>>16&65535,len=array.length,i=0;len>0;){tlen=len>param?param:len,len-=tlen;do s1+=array[i++],s2+=s1;while(--tlen);s1%=65521,s2%=65521}return(s2<<16|s1)>>>0},applyPngFilterMethod=function(bytes,lineLength,colorsPerPixel,filter_method){for(var line,prevLine,offset,lines=bytes.length/lineLength,result=new Uint8Array(bytes.length+lines),filter_methods=getFilterMethods(),i=0;lines>i;i++){if(offset=i*lineLength,line=bytes.subarray(offset,offset+lineLength),filter_method)result.set(filter_method(line,colorsPerPixel,prevLine),offset+i);else{for(var j=0,len=filter_methods.length,results=[];len>j;j++)results[j]=filter_methods[j](line,colorsPerPixel,prevLine);var ind=getIndexOfSmallestSum(results.concat());result.set(results[ind],offset+i)}prevLine=line}return result},filterNone=function(line){var result=Array.apply([],line);return result.unshift(0),result},filterSub=function(line,colorsPerPixel){var left,result=[],i=0,len=line.length;for(result[0]=1;len>i;i++)left=line[i-colorsPerPixel]||0,result[i+1]=line[i]-left+256&255;return result},filterUp=function(line,colorsPerPixel,prevLine){var up,result=[],i=0,len=line.length;for(result[0]=2;len>i;i++)up=prevLine&&prevLine[i]||0,result[i+1]=line[i]-up+256&255;return result},filterAverage=function(line,colorsPerPixel,prevLine){var left,up,result=[],i=0,len=line.length;for(result[0]=3;len>i;i++)left=line[i-colorsPerPixel]||0,up=prevLine&&prevLine[i]||0,result[i+1]=line[i]+256-(left+up>>>1)&255;return result},filterPaeth=function(line,colorsPerPixel,prevLine){var left,up,upLeft,paeth,result=[],i=0,len=line.length;for(result[0]=4;len>i;i++)left=line[i-colorsPerPixel]||0,up=prevLine&&prevLine[i]||0,upLeft=prevLine&&prevLine[i-colorsPerPixel]||0,paeth=paethPredictor(left,up,upLeft),result[i+1]=line[i]-paeth+256&255;return result},paethPredictor=function(left,up,upLeft){var p=left+up-upLeft,pLeft=Math.abs(p-left),pUp=Math.abs(p-up),pUpLeft=Math.abs(p-upLeft);return pUp>=pLeft&&pUpLeft>=pLeft?left:pUpLeft>=pUp?up:upLeft},getFilterMethods=function(){return[filterNone,filterSub,filterUp,filterAverage,filterPaeth]},getIndexOfSmallestSum=function(arrays){for(var sum,min,ind,i=0,len=arrays.length;len>i;)sum=absSum(arrays[i].slice(1)),(min>sum||!min)&&(min=sum,ind=i),i++;return ind},absSum=function(array){for(var i=0,len=array.length,sum=0;len>i;)sum+=Math.abs(array[i++]);return sum};jsPDFAPI.processPNG=function(imageData,imageIndex,alias,compression){var img,dp,trns,colors,pal,smask,colorSpace=this.color_spaces.DEVICE_RGB,decode=this.decode.FLATE_DECODE,bpc=8;if(this.isString(imageData),this.isArrayBuffer(imageData)&&(imageData=new Uint8Array(imageData)),this.isArrayBufferView(imageData)){if(doesNotHavePngJS())throw new Error("PNG support requires png.js and zlib.js");if(img=new PNG(imageData),imageData=img.imgData,bpc=img.bits,colorSpace=img.colorSpace,colors=img.colors,-1!==[4,6].indexOf(img.colorType)){if(8===img.bits)for(var pixel,pbl,pixelsArrayType=window["Uint"+img.pixelBitlength+"Array"],pixels=new pixelsArrayType(img.decodePixels().buffer),len=pixels.length,imgData=new Uint8Array(len*img.colors),alphaData=new Uint8Array(len),pDiff=img.pixelBitlength-img.bits,i=0,n=0;len>i;i++){for(pixel=pixels[i],pbl=0;pDiff>pbl;)imgData[n++]=pixel>>>pbl&255,pbl+=img.bits;alphaData[i]=pixel>>>pbl&255}if(16===img.bits){for(var pixel,pixels=new Uint32Array(img.decodePixels().buffer),len=pixels.length,imgData=new Uint8Array(len*(32/img.pixelBitlength)*img.colors),alphaData=new Uint8Array(len*(32/img.pixelBitlength)),hasColors=img.colors>1,i=0,n=0,a=0;len>i;)pixel=pixels[i++],imgData[n++]=pixel>>>0&255,hasColors&&(imgData[n++]=pixel>>>16&255,pixel=pixels[i++],imgData[n++]=pixel>>>0&255),alphaData[a++]=pixel>>>16&255;bpc=8}canCompress(compression)?(imageData=compressBytes(imgData,img.width*img.colors,img.colors,compression),smask=compressBytes(alphaData,img.width,1,compression)):(imageData=imgData,smask=alphaData,decode=null)}if(3===img.colorType&&(colorSpace=this.color_spaces.INDEXED,pal=img.palette,img.transparency.indexed)){for(var trans=img.transparency.indexed,total=0,i=0,len=trans.length;len>i;++i)total+=trans[i];if(total/=255,total===len-1&&-1!==trans.indexOf(0))trns=[trans.indexOf(0)];else if(total!==len){for(var pixels=img.decodePixels(),alphaData=new Uint8Array(pixels.length),i=0,len=pixels.length;len>i;i++)alphaData[i]=trans[pixels[i]];smask=compressBytes(alphaData,img.width,1)}}return dp=decode===this.decode.FLATE_DECODE?"/Predictor 15 /Colors "+colors+" /BitsPerComponent "+bpc+" /Columns "+img.width:"/Colors "+colors+" /BitsPerComponent "+bpc+" /Columns "+img.width,(this.isArrayBuffer(imageData)||this.isArrayBufferView(imageData))&&(imageData=this.arrayBufferToBinaryString(imageData)),(smask&&this.isArrayBuffer(smask)||this.isArrayBufferView(smask))&&(smask=this.arrayBufferToBinaryString(smask)),this.createImageInfo(imageData,img.width,img.height,colorSpace,bpc,decode,imageIndex,alias,dp,trns,pal,smask)}return info}}(jsPDF.API);var DecodeStream=function(){function constructor(){this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=null}return constructor.prototype={ensureBuffer:function(requested){var buffer=this.buffer,current=buffer?buffer.byteLength:0;if(current>requested)return buffer;for(var size=512;requested>size;)size<<=1;for(var buffer2=new Uint8Array(size),i=0;current>i;++i)buffer2[i]=buffer[i];return this.buffer=buffer2},getByte:function(){for(var pos=this.pos;this.bufferLength<=pos;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(length){var pos=this.pos;if(length){this.ensureBuffer(pos+length);for(var end=pos+length;!this.eof&&this.bufferLength<end;)this.readBlock();var bufEnd=this.bufferLength;end>bufEnd&&(end=bufEnd)}else{for(;!this.eof;)this.readBlock();var end=this.bufferLength}return this.pos=end,this.buffer.subarray(pos,end)},lookChar:function(){for(var pos=this.pos;this.bufferLength<=pos;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var pos=this.pos;this.bufferLength<=pos;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(start,length,dict){for(var end=start+length;this.bufferLength<=end&&!this.eof;)this.readBlock();return new Stream(this.buffer,start,length,dict)},skip:function(n){n||(n=1),this.pos+=n},reset:function(){this.pos=0}},constructor}(),FlateStream=function(){function error(e){throw new Error(e)}function constructor(bytes){var bytesPos=0,cmf=bytes[bytesPos++],flg=bytes[bytesPos++];(-1==cmf||-1==flg)&&error("Invalid header in flate stream"),8!=(15&cmf)&&error("Unknown compression method in flate stream"),((cmf<<8)+flg)%31!=0&&error("Bad FCHECK in flate stream"),32&flg&&error("FDICT bit set in flate stream"),this.bytes=bytes,this.bytesPos=bytesPos,this.codeSize=0,this.codeBuf=0,DecodeStream.call(this)}var codeLenCodeMap=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),lengthDecode=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),distDecode=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),fixedLitCodeTab=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],fixedDistCodeTab=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];return constructor.prototype=Object.create(DecodeStream.prototype),constructor.prototype.getBits=function(bits){for(var b,codeSize=this.codeSize,codeBuf=this.codeBuf,bytes=this.bytes,bytesPos=this.bytesPos;bits>codeSize;)"undefined"==typeof(b=bytes[bytesPos++])&&error("Bad encoding in flate stream"),codeBuf|=b<<codeSize,codeSize+=8;return b=codeBuf&(1<<bits)-1,this.codeBuf=codeBuf>>bits,this.codeSize=codeSize-=bits,this.bytesPos=bytesPos,b},constructor.prototype.getCode=function(table){for(var codes=table[0],maxLen=table[1],codeSize=this.codeSize,codeBuf=this.codeBuf,bytes=this.bytes,bytesPos=this.bytesPos;maxLen>codeSize;){var b;"undefined"==typeof(b=bytes[bytesPos++])&&error("Bad encoding in flate stream"),codeBuf|=b<<codeSize,codeSize+=8}var code=codes[codeBuf&(1<<maxLen)-1],codeLen=code>>16,codeVal=65535&code;return(0==codeSize||codeLen>codeSize||0==codeLen)&&error("Bad encoding in flate stream"),this.codeBuf=codeBuf>>codeLen,this.codeSize=codeSize-codeLen,this.bytesPos=bytesPos,codeVal},constructor.prototype.generateHuffmanTable=function(lengths){for(var n=lengths.length,maxLen=0,i=0;n>i;++i)lengths[i]>maxLen&&(maxLen=lengths[i]);for(var size=1<<maxLen,codes=new Uint32Array(size),len=1,code=0,skip=2;maxLen>=len;++len,code<<=1,skip<<=1)for(var val=0;n>val;++val)if(lengths[val]==len){for(var code2=0,t=code,i=0;len>i;++i)code2=code2<<1|1&t,t>>=1;for(var i=code2;size>i;i+=skip)codes[i]=len<<16|val;++code}return[codes,maxLen]},constructor.prototype.readBlock=function(){function repeat(stream,array,len,offset,what){for(var repeat=stream.getBits(len)+offset;repeat-->0;)array[i++]=what}var hdr=this.getBits(3);if(1&hdr&&(this.eof=!0),hdr>>=1,0==hdr){var b,bytes=this.bytes,bytesPos=this.bytesPos;"undefined"==typeof(b=bytes[bytesPos++])&&error("Bad block header in flate stream");var blockLen=b;"undefined"==typeof(b=bytes[bytesPos++])&&error("Bad block header in flate stream"),blockLen|=b<<8,"undefined"==typeof(b=bytes[bytesPos++])&&error("Bad block header in flate stream");var check=b;"undefined"==typeof(b=bytes[bytesPos++])&&error("Bad block header in flate stream"),check|=b<<8,check!=(65535&~blockLen)&&error("Bad uncompressed block length in flate stream"),this.codeBuf=0,this.codeSize=0;var bufferLength=this.bufferLength,buffer=this.ensureBuffer(bufferLength+blockLen),end=bufferLength+blockLen;this.bufferLength=end;for(var n=bufferLength;end>n;++n){if("undefined"==typeof(b=bytes[bytesPos++])){this.eof=!0;break}buffer[n]=b}return void(this.bytesPos=bytesPos)}var litCodeTable,distCodeTable;if(1==hdr)litCodeTable=fixedLitCodeTab,distCodeTable=fixedDistCodeTab;else if(2==hdr){for(var numLitCodes=this.getBits(5)+257,numDistCodes=this.getBits(5)+1,numCodeLenCodes=this.getBits(4)+4,codeLenCodeLengths=Array(codeLenCodeMap.length),i=0;numCodeLenCodes>i;)codeLenCodeLengths[codeLenCodeMap[i++]]=this.getBits(3);for(var codeLenCodeTab=this.generateHuffmanTable(codeLenCodeLengths),len=0,i=0,codes=numLitCodes+numDistCodes,codeLengths=new Array(codes);codes>i;){var code=this.getCode(codeLenCodeTab);16==code?repeat(this,codeLengths,2,3,len):17==code?repeat(this,codeLengths,3,3,len=0):18==code?repeat(this,codeLengths,7,11,len=0):codeLengths[i++]=len=code}litCodeTable=this.generateHuffmanTable(codeLengths.slice(0,numLitCodes)),distCodeTable=this.generateHuffmanTable(codeLengths.slice(numLitCodes,codes))}else error("Unknown block type in flate stream");for(var buffer=this.buffer,limit=buffer?buffer.length:0,pos=this.bufferLength;;){var code1=this.getCode(litCodeTable);if(256>code1)pos+1>=limit&&(buffer=this.ensureBuffer(pos+1),limit=buffer.length),buffer[pos++]=code1;else{if(256==code1)return void(this.bufferLength=pos);code1-=257,code1=lengthDecode[code1];var code2=code1>>16;code2>0&&(code2=this.getBits(code2));var len=(65535&code1)+code2;code1=this.getCode(distCodeTable),code1=distDecode[code1],code2=code1>>16,code2>0&&(code2=this.getBits(code2));var dist=(65535&code1)+code2;pos+len>=limit&&(buffer=this.ensureBuffer(pos+len),limit=buffer.length);for(var k=0;len>k;++k,++pos)buffer[pos]=buffer[pos-dist]}}},constructor}();(function(){var PNG;PNG=function(){function PNG(data){var chunkSize,colors,palLen,delayDen,delayNum,frame,i,index,key,section,short,text,_i,_j,_ref;for(this.data=data,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},frame=null;;){switch(chunkSize=this.readUInt32(),section=function(){var _i,_results;for(_results=[],i=_i=0;4>_i;i=++_i)_results.push(String.fromCharCode(this.data[this.pos++]));return _results}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(chunkSize);break;case"fcTL":frame&&this.animation.frames.push(frame),this.pos+=4,frame={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},delayNum=this.readUInt16(),delayDen=this.readUInt16()||100,frame.delay=1e3*delayNum/delayDen,frame.disposeOp=this.data[this.pos++],frame.blendOp=this.data[this.pos++],frame.data=[];break;case"IDAT":case"fdAT":for("fdAT"===section&&(this.pos+=4,chunkSize-=4),data=(null!=frame?frame.data:void 0)||this.imgData,i=_i=0;chunkSize>=0?chunkSize>_i:_i>chunkSize;i=chunkSize>=0?++_i:--_i)data.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(palLen=this.palette.length/3,this.transparency.indexed=this.read(chunkSize),this.transparency.indexed.length>palLen)throw new Error("More transparent colors than palette size");if(short=palLen-this.transparency.indexed.length,short>0)for(i=_j=0;short>=0?short>_j:_j>short;i=short>=0?++_j:--_j)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(chunkSize)[0];break;case 2:this.transparency.rgb=this.read(chunkSize)}break;case"tEXt":text=this.read(chunkSize),index=text.indexOf(0),key=String.fromCharCode.apply(String,text.slice(0,index)),this.text[key]=String.fromCharCode.apply(String,text.slice(index+1));break;case"IEND":return frame&&this.animation.frames.push(frame),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(_ref=this.colorType)||6===_ref,colors=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*colors,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=chunkSize}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}var APNG_BLEND_OP_OVER,APNG_BLEND_OP_SOURCE,APNG_DISPOSE_OP_BACKGROUND,APNG_DISPOSE_OP_NONE,APNG_DISPOSE_OP_PREVIOUS,makeImage,scratchCanvas,scratchCtx;return PNG.load=function(url,canvas,callback){var xhr;return"function"==typeof canvas&&(callback=canvas),xhr=new XMLHttpRequest,xhr.open("GET",url,!0),xhr.responseType="arraybuffer",xhr.onload=function(){var data,png;return data=new Uint8Array(xhr.response||xhr.mozResponseArrayBuffer),png=new PNG(data),"function"==typeof(null!=canvas?canvas.getContext:void 0)&&png.render(canvas),"function"==typeof callback?callback(png):void 0},xhr.send(null)},APNG_DISPOSE_OP_NONE=0,APNG_DISPOSE_OP_BACKGROUND=1,APNG_DISPOSE_OP_PREVIOUS=2,APNG_BLEND_OP_SOURCE=0,APNG_BLEND_OP_OVER=1,PNG.prototype.read=function(bytes){var i,_i,_results;for(_results=[],i=_i=0;bytes>=0?bytes>_i:_i>bytes;i=bytes>=0?++_i:--_i)_results.push(this.data[this.pos++]);return _results},PNG.prototype.readUInt32=function(){var b1,b2,b3,b4;return b1=this.data[this.pos++]<<24,b2=this.data[this.pos++]<<16,b3=this.data[this.pos++]<<8,b4=this.data[this.pos++],b1|b2|b3|b4},PNG.prototype.readUInt16=function(){var b1,b2;return b1=this.data[this.pos++]<<8,b2=this.data[this.pos++],b1|b2},PNG.prototype.decodePixels=function(data){var byte,c,col,i,left,length,p,pa,paeth,pb,pc,pixelBytes,pixels,pos,row,scanlineLength,upper,upperLeft,_i,_j,_k,_l,_m;if(null==data&&(data=this.imgData),0===data.length)return new Uint8Array(0);for(data=new FlateStream(data),data=data.getBytes(),pixelBytes=this.pixelBitlength/8,scanlineLength=pixelBytes*this.width,pixels=new Uint8Array(scanlineLength*this.height),length=data.length,row=0,pos=0,c=0;length>pos;){switch(data[pos++]){case 0:for(i=_i=0;scanlineLength>_i;i=_i+=1)pixels[c++]=data[pos++];break;case 1:for(i=_j=0;scanlineLength>_j;i=_j+=1)byte=data[pos++],left=pixelBytes>i?0:pixels[c-pixelBytes],pixels[c++]=(byte+left)%256;break;case 2:for(i=_k=0;scanlineLength>_k;i=_k+=1)byte=data[pos++],col=(i-i%pixelBytes)/pixelBytes,upper=row&&pixels[(row-1)*scanlineLength+col*pixelBytes+i%pixelBytes],pixels[c++]=(upper+byte)%256;break;case 3:for(i=_l=0;scanlineLength>_l;i=_l+=1)byte=data[pos++],col=(i-i%pixelBytes)/pixelBytes,left=pixelBytes>i?0:pixels[c-pixelBytes],upper=row&&pixels[(row-1)*scanlineLength+col*pixelBytes+i%pixelBytes],pixels[c++]=(byte+Math.floor((left+upper)/2))%256;break;case 4:for(i=_m=0;scanlineLength>_m;i=_m+=1)byte=data[pos++],col=(i-i%pixelBytes)/pixelBytes,left=pixelBytes>i?0:pixels[c-pixelBytes],0===row?upper=upperLeft=0:(upper=pixels[(row-1)*scanlineLength+col*pixelBytes+i%pixelBytes],upperLeft=col&&pixels[(row-1)*scanlineLength+(col-1)*pixelBytes+i%pixelBytes]),p=left+upper-upperLeft,pa=Math.abs(p-left),pb=Math.abs(p-upper),pc=Math.abs(p-upperLeft),paeth=pb>=pa&&pc>=pa?left:pc>=pb?upper:upperLeft,pixels[c++]=(byte+paeth)%256;break;default:throw new Error("Invalid filter algorithm: "+data[pos-1])}row++}return pixels},PNG.prototype.decodePalette=function(){var c,i,length,palette,pos,ret,transparency,_i,_ref,_ref1;for(palette=this.palette,transparency=this.transparency.indexed||[],ret=new Uint8Array((transparency.length||0)+palette.length),pos=0,length=palette.length,c=0,i=_i=0,_ref=palette.length;_ref>_i;i=_i+=3)ret[pos++]=palette[i],ret[pos++]=palette[i+1],ret[pos++]=palette[i+2],ret[pos++]=null!=(_ref1=transparency[c++])?_ref1:255;return ret},PNG.prototype.copyToImageData=function(imageData,pixels){var alpha,colors,data,i,input,j,k,length,palette,v,_ref;if(colors=this.colors,palette=null,alpha=this.hasAlphaChannel,this.palette.length&&(palette=null!=(_ref=this._decodedPalette)?_ref:this._decodedPalette=this.decodePalette(),colors=4,alpha=!0),data=imageData.data||imageData,length=data.length,input=palette||pixels,i=j=0,1===colors)for(;length>i;)k=palette?4*pixels[i/4]:j,v=input[k++],data[i++]=v,data[i++]=v,data[i++]=v,data[i++]=alpha?input[k++]:255,j=k;else for(;length>i;)k=palette?4*pixels[i/4]:j,data[i++]=input[k++],data[i++]=input[k++],data[i++]=input[k++],data[i++]=alpha?input[k++]:255,j=k},PNG.prototype.decode=function(){var ret;return ret=new Uint8Array(this.width*this.height*4),this.copyToImageData(ret,this.decodePixels()),ret},scratchCanvas=document.createElement("canvas"),scratchCtx=scratchCanvas.getContext("2d"),makeImage=function(imageData){var img;return scratchCtx.width=imageData.width,scratchCtx.height=imageData.height,scratchCtx.clearRect(0,0,imageData.width,imageData.height),scratchCtx.putImageData(imageData,0,0),img=new Image,img.src=scratchCanvas.toDataURL(),img},PNG.prototype.decodeFrames=function(ctx){var frame,i,imageData,pixels,_i,_len,_ref,_results;if(this.animation){for(_ref=this.animation.frames,_results=[],i=_i=0,_len=_ref.length;_len>_i;i=++_i)frame=_ref[i],imageData=ctx.createImageData(frame.width,frame.height),pixels=this.decodePixels(new Uint8Array(frame.data)),this.copyToImageData(imageData,pixels),frame.imageData=imageData,_results.push(frame.image=makeImage(imageData));return _results}},PNG.prototype.renderFrame=function(ctx,number){var frame,frames,prev;return frames=this.animation.frames,frame=frames[number],prev=frames[number-1],0===number&&ctx.clearRect(0,0,this.width,this.height),(null!=prev?prev.disposeOp:void 0)===APNG_DISPOSE_OP_BACKGROUND?ctx.clearRect(prev.xOffset,prev.yOffset,prev.width,prev.height):(null!=prev?prev.disposeOp:void 0)===APNG_DISPOSE_OP_PREVIOUS&&ctx.putImageData(prev.imageData,prev.xOffset,prev.yOffset),frame.blendOp===APNG_BLEND_OP_SOURCE&&ctx.clearRect(frame.xOffset,frame.yOffset,frame.width,frame.height),ctx.drawImage(frame.image,frame.xOffset,frame.yOffset)},PNG.prototype.animate=function(ctx){var doFrame,frameNumber,frames,numFrames,numPlays,_ref,_this=this;return frameNumber=0,_ref=this.animation,numFrames=_ref.numFrames,frames=_ref.frames,numPlays=_ref.numPlays,(doFrame=function(){var f,frame;return f=frameNumber++%numFrames,frame=frames[f],_this.renderFrame(ctx,f),
numFrames>1&&numPlays>frameNumber/numFrames?_this.animation._timeout=setTimeout(doFrame,frame.delay):void 0})()},PNG.prototype.stopAnimation=function(){var _ref;return clearTimeout(null!=(_ref=this.animation)?_ref._timeout:void 0)},PNG.prototype.render=function(canvas){var ctx,data;return canvas._png&&canvas._png.stopAnimation(),canvas._png=this,canvas.width=this.width,canvas.height=this.height,ctx=canvas.getContext("2d"),this.animation?(this.decodeFrames(ctx),this.animate(ctx)):(data=ctx.createImageData(this.width,this.height),this.copyToImageData(data,this.decodePixels()),ctx.putImageData(data,0,0))},PNG}(),window.PNG=PNG}).call(this);